<!-- Main Navigation Bar (RBAC-enabled) -->
<nav class="bg-white shadow-lg sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8">
    <div class="flex justify-between h-14 sm:h-16">
      
      <!-- Logo and Brand -->
      <div class="flex items-center gap-2">
        <img src="/GC-Logo.png" alt="GC Logo" class="h-8 w-8 sm:h-10 sm:w-10">
        <span class="text-base sm:text-xl font-bold text-[#679436]">GC-ORGANIZE</span>
      </div>

      <!-- Desktop Navigation Links -->
      <div class="hidden md:flex items-center space-x-4">
        
        <!-- Student Panel Link -->
        <a *ngIf="isStudent" 
           routerLink="/student-dashboard/home" 
           routerLinkActive="bg-[#679436] text-white"
           class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-[#679436] hover:text-white transition-colors duration-200">
          <i class="fas fa-user-graduate mr-2"></i>
          Student Panel
        </a>

        <!-- Organization Panel Link -->
        <a *ngIf="isOrgOfficer" 
           routerLink="/org-panel/dashboard" 
           routerLinkActive="bg-[#679436] text-white"
           class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-[#679436] hover:text-white transition-colors duration-200">
          <i class="fas fa-users mr-2"></i>
          Organization Panel
        </a>

        <!-- Admin Panel Link -->
        <a *ngIf="isAdmin" 
           routerLink="/osws-admin/dashboard" 
           routerLinkActive="bg-[#679436] text-white"
           class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-[#679436] hover:text-white transition-colors duration-200">
          <i class="fas fa-shield-alt mr-2"></i>
          Admin Panel
        </a>

        <!-- User Menu Dropdown -->
        <div class="relative ml-3">
          <button 
            (click)="toggleUserMenu()"
            class="flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#679436]">
            <div class="h-8 w-8 rounded-full bg-[#679436] text-white flex items-center justify-center font-medium">
              {{ userName.charAt(0).toUpperCase() }}
            </div>
            <i class="fas fa-chevron-down ml-2 text-gray-600"></i>
          </button>

          <!-- Dropdown Menu -->
          <div *ngIf="isUserMenuOpen" 
               class="origin-top-right absolute right-0 mt-2 w-64 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 divide-y divide-gray-100">
            
            <!-- User Info Section -->
            <div class="px-4 py-3">
              <p class="text-sm font-medium text-gray-900">{{ userName }}</p>
              <p class="text-xs text-gray-500 truncate">{{ userEmail }}</p>
              
              <!-- Role Badges -->
              <div class="mt-2 flex flex-wrap gap-1">
                <span *ngFor="let role of roleBadges" 
                      [ngClass]="getBadgeClass(role)"
                      class="px-2 py-1 text-xs font-medium rounded-full">
                  {{ role }}
                </span>
              </div>

              <!-- Organization Info -->
              <div *ngIf="userOrganization" class="mt-2 text-xs text-gray-600">
                <i class="fas fa-building mr-1"></i>
                {{ userOrganization.org_name }} - {{ userOrganization.position }}
              </div>
            </div>

            <!-- Menu Items -->
            <div class="py-1">
              <a routerLink="/profile" 
                 (click)="closeMenus()"
                 class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                <i class="fas fa-user mr-2"></i>
                My Profile
              </a>
              
              <a *ngIf="isStudent" 
                 routerLink="/student-dashboard/request-role" 
                 (click)="closeMenus()"
                 class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                <i class="fas fa-hand-paper mr-2"></i>
                Request Officer Role
              </a>
            </div>

            <!-- Logout -->
            <div class="py-1">
              <button 
                (click)="logout()"
                class="block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50">
                <i class="fas fa-sign-out-alt mr-2"></i>
                Logout
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile Menu Button -->
      <div class="md:hidden flex items-center">
        <button 
          (click)="toggleMobileMenu()"
          class="inline-flex items-center justify-center p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-[#679436] min-h-[44px] min-w-[44px]">
          <i class="fas text-xl" [ngClass]="isMobileMenuOpen ? 'fa-times' : 'fa-bars'"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div *ngIf="isMobileMenuOpen" class="md:hidden border-t border-gray-200">
    <div class="px-3 py-3 space-y-1 max-h-[calc(100vh-4rem)] overflow-y-auto">
      
      <!-- User Info (Mobile) -->
      <div class="px-3 py-3 border-b border-gray-200 mb-2">
        <p class="text-sm font-medium text-gray-900 break-words">{{ userName }}</p>
        <p class="text-xs text-gray-500 break-all">{{ userEmail }}</p>
        <div class="mt-2 flex flex-wrap gap-1">
          <span *ngFor="let role of roleBadges" 
                [ngClass]="getBadgeClass(role)"
                class="px-2 py-1 text-xs font-medium rounded-full">
            {{ role }}
          </span>
        </div>
      </div>

      <!-- Student Panel Link (Mobile) -->
      <a *ngIf="isStudent" 
         routerLink="/student-dashboard/home"
         (click)="closeMenus()"
         routerLinkActive="bg-[#679436] text-white"
         class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-[#679436] hover:text-white">
        <i class="fas fa-user-graduate mr-2"></i>
        Student Panel
      </a>

      <!-- Organization Panel Link (Mobile) -->
      <a *ngIf="isOrgOfficer" 
         routerLink="/org-panel/dashboard"
         (click)="closeMenus()"
         routerLinkActive="bg-[#679436] text-white"
         class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-[#679436] hover:text-white">
        <i class="fas fa-users mr-2"></i>
        Organization Panel
      </a>

      <!-- Admin Panel Link (Mobile) -->
      <a *ngIf="isAdmin" 
         routerLink="/osws-admin/dashboard"
         (click)="closeMenus()"
         routerLinkActive="bg-[#679436] text-white"
         class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-[#679436] hover:text-white">
        <i class="fas fa-shield-alt mr-2"></i>
        Admin Panel
      </a>

      <!-- Divider -->
      <div class="border-t border-gray-200 my-2"></div>

      <!-- Profile Link (Mobile) -->
      <a routerLink="/profile"
         (click)="closeMenus()"
         class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-100">
        <i class="fas fa-user mr-2"></i>
        My Profile
      </a>

      <!-- Request Role Link (Mobile) -->
      <a *ngIf="isStudent" 
         routerLink="/student-dashboard/request-role"
         (click)="closeMenus()"
         class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-100">
        <i class="fas fa-hand-paper mr-2"></i>
        Request Officer Role
      </a>

      <!-- Logout (Mobile) -->
      <button 
        (click)="logout()"
        class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-red-700 hover:bg-red-50">
        <i class="fas fa-sign-out-alt mr-2"></i>
        Logout
      </button>
    </div>
  </div>
</nav>

<!-- Click Outside to Close Menus -->
<div *ngIf="isUserMenuOpen || isMobileMenuOpen" 
     (click)="closeMenus()" 
     class="fixed inset-0 z-40" 
     aria-hidden="true">
</div>
