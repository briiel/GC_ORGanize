<div class="p-6 bg-gray-100 min-h-screen">
	<!-- Header -->
	<div class="mb-6 mx-2 lg:mx-6">
		<div class="bg-gradient-to-r shadow-2xl rounded-2xl overflow-hidden border-2"
			 [ngClass]="isOsws ? 'from-[#14532d] to-[#166534] border-[#14532d]' : 'from-[#679436] to-[#56732e] border-[#679436]'">
			<div class="px-6 py-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3">
				<div class="flex items-center gap-3">
					<div class="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center flex-shrink-0 border-2 border-white/30">
						<i class="fas fa-archive text-white text-xl"></i>
					</div>
					<div>
						<div class="flex items-center gap-2">
							<h1 class="text-xl sm:text-2xl font-bold text-white">Archive</h1>
							<span class="inline-flex items-center justify-center text-xs font-semibold px-2.5 py-1 rounded-full bg-white/20 text-white border border-white/30"
								  *ngIf="filtered && filtered.length >= 0">{{ filtered.length }}</span>
						</div>
						<p class="text-white/80 text-sm mt-0.5">Archived events ready for restore</p>
					</div>
				</div>
				<div class="flex items-center gap-2 w-full sm:w-auto">
					<div class="relative flex-1 sm:flex-none sm:w-[300px] lg:w-[400px]">
						<i class="fas fa-search text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"></i>
						<input
							type="text"
							class="w-full pl-9 pr-8 py-2.5 border-2 border-gray-300 bg-white text-gray-800 placeholder-gray-400 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent shadow-sm"
							[ngClass]="isOsws ? 'focus:ring-[#14532d]' : 'focus:ring-[#679436]'"
							placeholder="Search title, department, host…"
							aria-label="Search archive"
							[ngModel]="search"
							(ngModelChange)="onSearchChange($event)"
						/>
						<button *ngIf="search" type="button" aria-label="Clear search"
								class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors duration-200"
								(click)="search=''">
							<i class="fas fa-times"></i>
						</button>
					</div>
					<button type="button"
							class="text-white font-semibold px-4 py-2.5 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl flex items-center gap-2 bg-white/20 hover:bg-white/30 border-2 border-white/30"
							(click)="loadTrash()">
						<i class="fas fa-rotate"></i>
						<span class="hidden sm:inline">Refresh</span>
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Loading state -->
	<div *ngIf="loading" role="status" aria-live="polite" class="mx-2 lg:mx-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
		<div *ngFor="let i of [1,2,3,4,5,6]" class="border-2 border-gray-200 rounded-2xl overflow-hidden bg-white shadow-lg">
			<div class="h-36 bg-gray-100 animate-pulse"></div>
			<div class="p-4 space-y-2">
				<div class="h-4 bg-gray-100 rounded w-2/3 animate-pulse"></div>
				<div class="h-3 bg-gray-100 rounded w-1/2 animate-pulse"></div>
				<div class="h-3 bg-gray-100 rounded w-1/3 animate-pulse"></div>
			</div>
		</div>
	</div>

	<!-- Error state -->
	<div *ngIf="error" class="mx-2 lg:mx-6 flex items-start gap-3 p-4 mb-6 rounded-2xl border-2 border-red-200 bg-red-50 text-red-700 shadow-lg">
		<i class="fas fa-circle-exclamation text-xl mt-0.5"></i>
		<div class="flex-1">
			<div class="font-bold text-base">Couldn't load archive</div>
			<div class="text-sm mt-1">{{ error }}</div>
		</div>
		<button type="button" 
				class="px-4 py-2 rounded-lg border-2 border-red-300 bg-white hover:bg-red-100 font-semibold transition-colors duration-200" 
				(click)="loadTrash()">
			Try again
		</button>
	</div>

	<!-- Empty state -->
	<div *ngIf="!loading && !error && filtered.length === 0" class="text-gray-600 mx-2 lg:mx-6">
		<div class="flex flex-col items-center justify-center text-center py-16 border-2 border-dashed border-gray-300 rounded-2xl bg-white shadow-lg">
			<div class="w-20 h-20 rounded-full bg-gray-100 flex items-center justify-center mb-4">
				<i class="fas fa-archive text-4xl text-gray-400"></i>
			</div>
			<div class="text-xl font-bold text-gray-700 mb-2">No items in archive</div>
			<div class="text-sm text-gray-500 max-w-md">Archived events will appear here. You can restore them or delete them permanently.</div>
		</div>
	</div>

	<!-- Results -->
	<div *ngIf="!loading && !error && filtered.length > 0" class="mx-2 lg:mx-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
		<div *ngFor="let ev of paginated" class="group flex flex-col border-2 border-gray-200 rounded-2xl overflow-hidden bg-white shadow-lg hover:shadow-2xl transition-all duration-200">
			<div class="h-36 bg-gradient-to-br from-gray-100 to-gray-200 bg-cover bg-center relative" [style.backgroundImage]="posterUrl(ev) ? 'url(' + posterUrl(ev) + ')' : ''">
				<div class="absolute inset-0 flex items-center justify-center text-gray-300 text-4xl" *ngIf="!posterUrl(ev)">
					<i class="fas fa-image"></i>
				</div>
				<!-- Status indicator badge -->
				<div class="absolute top-2 left-2 inline-flex items-center gap-1 text-xs font-semibold px-2.5 py-1 rounded-full shadow-lg border-2"
					 [ngClass]="{
						'bg-green-100 text-green-800 border-green-300': (ev.status || '').toLowerCase() === 'concluded',
						'bg-yellow-100 text-yellow-800 border-yellow-300': (ev.status || '').toLowerCase() === 'ongoing',
						'bg-gray-100 text-gray-800 border-gray-300': (ev.status || '').toLowerCase() === 'not yet started',
						'bg-red-100 text-red-800 border-red-300': (ev.status || '').toLowerCase() === 'cancelled'
					 }">
					<i class="fas" [ngClass]="{
						'fa-circle-check': (ev.status || '').toLowerCase() === 'concluded',
						'fa-play': (ev.status || '').toLowerCase() === 'ongoing',
						'fa-clock': (ev.status || '').toLowerCase() === 'not yet started',
						'fa-ban': (ev.status || '').toLowerCase() === 'cancelled'
					 }"></i>
					<span class="uppercase tracking-wide">{{ (ev.status || 'unknown') }}</span>
				</div>
			</div>
			<div class="p-4 space-y-2.5 flex-1">
				<div class="font-bold text-base truncate"
					 [ngClass]="isOsws ? 'text-[#14532d]' : 'text-[#679436]'"
					 [title]="ev.title">{{ ev.title }}</div>
				<div class="flex gap-3 flex-wrap text-gray-600 text-xs">
					<span class="inline-flex items-center gap-1.5" [title]="ev.start_date | date:'fullDate'">
						<i class="far fa-calendar"></i>
						<span>{{ ev.start_date | date:'mediumDate' }}</span>
					</span>
					<span class="inline-flex items-center gap-1.5 truncate max-w-full" [title]="ev.location || '—'">
						<i class="fas fa-map-marker-alt"></i>
						<span class="truncate">{{ ev.location || '—' }}</span>
					</span>
				</div>
				<div class="flex gap-2 flex-wrap text-gray-700 text-xs">
					<span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-gray-100 border border-gray-200">
						<i class="fas fa-user"></i>
						<span class="truncate">{{ ev.org_name || ev.admin_name || '—' }}</span>
					</span>
					<span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-gray-100 border border-gray-200">
						<i class="fas fa-tag"></i>
						<span>{{ ev.department || '—' }}</span>
					</span>
				</div>
				<div class="text-xs text-gray-500 flex items-center gap-1.5 pt-1">
					<i class="far fa-clock"></i>
					<span>Deleted {{ ev.deleted_at | date:'medium' }}</span>
				</div>
			</div>
			<div class="flex justify-end p-4 gap-2 border-t-2 border-gray-100 bg-gray-50">
				<button type="button" 
						aria-label="Restore event"
						class="px-3 py-2.5 rounded-lg text-white font-semibold transition-all duration-200 shadow-md hover:shadow-lg flex items-center justify-center bg-gradient-to-r"
						[ngClass]="isOsws ? 'from-[#14532d] to-[#166534] hover:from-[#166534] hover:to-[#14532d]' : 'from-[#679436] to-[#56732e] hover:from-[#56732e] hover:to-[#679436]'"
						(click)="restore(ev.event_id)">
					<i class="fas fa-undo"></i>
				</button>
				<button type="button" 
						aria-label="Delete forever"
						class="px-3 py-2.5 rounded-lg text-white font-semibold transition-all duration-200 shadow-md hover:shadow-lg flex items-center justify-center bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800"
						(click)="deleteForever(ev.event_id)">
					<i class="fas fa-trash-alt"></i>
				</button>
			</div>
		</div>
	</div>
	<!-- Pagination -->
	<div *ngIf="!loading && !error && totalPages > 1" class="mx-2 lg:mx-6 mt-6 mb-8 flex justify-center">
		<nav class="inline-flex space-x-1" aria-label="Pagination">
			<button class="w-9 h-9 flex items-center justify-center rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50 transition-colors duration-150"
					[disabled]="currentPage === 1"
					(click)="changePage(currentPage - 1)">
				<i class="fas fa-chevron-left"></i>
			</button>
			<ng-container *ngFor="let page of [].constructor(totalPages); let i = index">
				<button class="w-9 h-9 flex items-center justify-center rounded transition-colors duration-150"
						[ngClass]="currentPage === (i + 1) ? 
							(isOsws ? 'bg-[#14532d] text-white font-bold' : 'bg-[#679436] text-white font-bold') : 
							'bg-gray-200 hover:bg-gray-300 text-gray-800'"
						[attr.aria-current]="currentPage === (i + 1) ? 'page' : null"
						(click)="changePage(i + 1)">
					{{ i + 1 }}
				</button>
			</ng-container>
			<button class="w-9 h-9 flex items-center justify-center rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50 transition-colors duration-150"
					[disabled]="currentPage === totalPages"
					(click)="changePage(currentPage + 1)">
				<i class="fas fa-chevron-right"></i>
			</button>
		</nav>
	</div>
</div>
