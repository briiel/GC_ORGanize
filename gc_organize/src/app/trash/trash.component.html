<div class="p-2 sm:p-4 lg:p-6 bg-gray-100 min-h-screen">
	<!-- Header -->
	<div class="mb-4 sm:mb-5 lg:mb-6 mx-0 sm:mx-2 lg:mx-6">
		<div class="bg-white rounded-lg shadow-md p-3 sm:p-4 lg:p-5"
			 [ngClass]="isOsws ? 'border-l-4 gc-border-admin' : 'border-l-4 gc-border-primary'">
			<div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3">
				<div class="flex items-center gap-2 sm:gap-3 min-w-0 flex-1">
                        <div class="w-9 h-9 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center flex-shrink-0"
                         	 [ngClass]="isOsws ? 'gc-bg-admin' : 'gc-bg-primary'">
						<i class="fas fa-archive text-white text-sm sm:text-base"></i>
					</div>
					<div class="min-w-0">
						<div class="flex items-center gap-2">
							<h1 class="text-base sm:text-lg lg:text-xl font-bold text-gray-800">Archive</h1>
							<span class="inline-flex items-center justify-center text-[10px] sm:text-xs font-semibold px-2 py-1 rounded-full bg-gray-100 text-gray-700"
								  *ngIf="filtered && filtered.length >= 0">{{ filtered.length }}</span>
						</div>
						<p class="text-xs sm:text-sm text-gray-600 truncate">Archived items (30-day retention)</p>
					</div>
				</div>
				<div class="flex items-center gap-1.5 sm:gap-2 w-full sm:w-auto">
					<div class="relative flex-1 sm:flex-none sm:w-[220px] md:w-[300px]">
						<input
							type="text"
							class="w-full px-3 sm:px-4 py-2.5 border-2 border-gray-300 bg-white text-gray-800 placeholder-gray-400 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all text-sm sm:text-base min-h-[44px]"
							 [ngClass]="isOsws ? 'gc-focus-admin' : 'gc-focus-primary'"
							placeholder="Search archived items..."
							aria-label="Search archive"
							[ngModel]="search"
							(ngModelChange)="onSearchChange($event)"
						/>
					</div>
					<button *ngIf="search" type="button" aria-label="Clear search"
							class="px-3 sm:px-4 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-all duration-200 font-semibold border-2 border-gray-300 flex items-center gap-1.5 sm:gap-2 min-h-[44px] min-w-[44px] flex-shrink-0"
							(click)="search=''">
						<i class="fas fa-times text-xs sm:text-sm"></i>
						<span class="hidden sm:inline text-sm">Clear</span>
					</button>
					    <button type="button"
						    class="px-3 sm:px-4 py-2.5 rounded-lg transition-colors font-semibold shadow-sm hover:shadow flex items-center gap-1.5 sm:gap-2 text-white min-h-[44px] min-w-[44px] flex-shrink-0"
						    [ngClass]="isOsws ? 'gc-btn-admin' : 'gc-btn-primary'"
						    (click)="loadTrash()">
						<i class="fas fa-rotate text-xs sm:text-sm"></i>
						<span class="hidden sm:inline text-sm">Refresh</span>
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Tabs -->
	<div class="mx-0 sm:mx-2 lg:mx-6 mb-4">
		<div class="bg-white rounded-lg shadow-md overflow-hidden">
			<div class="flex flex-wrap border-b border-gray-200">
				<!-- Events Tab -->
				<button (click)="setActiveTab('events')" 
						class="flex-1 min-w-[120px] px-4 py-3 text-sm font-semibold transition-colors border-b-2"
						[ngClass]="activeTab === 'events' 
							? (isOsws ? 'gc-border-admin bg-[var(--gc-admin)]/10 gc-text-admin' : 'gc-border-primary bg-[var(--gc-primary)]/10 gc-text-primary')
							: 'border-transparent text-gray-600 hover:bg-gray-50'">
					<i class="fas fa-calendar-alt mr-2"></i>
					Events
					<span class="ml-2 px-2 py-0.5 rounded-full text-xs bg-gray-100">{{ trashedEvents.length }}</span>
				</button>
				
				<!-- Admins Tab (OSWS only) -->
				<button *ngIf="canSeeAdminsTab" (click)="setActiveTab('admins')" 
						class="flex-1 min-w-[120px] px-4 py-3 text-sm font-semibold transition-colors border-b-2"
						[ngClass]="activeTab === 'admins' 
							? 'gc-border-admin bg-[var(--gc-admin)]/10 gc-text-admin'
							: 'border-transparent text-gray-600 hover:bg-gray-50'">
					<i class="fas fa-user-shield mr-2"></i>
					Admins
					<span class="ml-2 px-2 py-0.5 rounded-full text-xs bg-gray-100">{{ trashedAdmins.length }}</span>
				</button>
				
				<!-- Organizations Tab (OSWS only) -->
				<button *ngIf="canSeeOrganizationsTab" (click)="setActiveTab('organizations')" 
						class="flex-1 min-w-[120px] px-4 py-3 text-sm font-semibold transition-colors border-b-2"
						[ngClass]="activeTab === 'organizations' 
							? 'gc-border-admin bg-[var(--gc-admin)]/10 gc-text-admin'
							: 'border-transparent text-gray-600 hover:bg-gray-50'">
					<i class="fas fa-users mr-2"></i>
					Organizations
					<span class="ml-2 px-2 py-0.5 rounded-full text-xs bg-gray-100">{{ trashedOrganizations.length }}</span>
				</button>
				
				<!-- Members Tab -->
				<button *ngIf="canSeeMembersTab" (click)="setActiveTab('members')" 
						class="flex-1 min-w-[120px] px-4 py-3 text-sm font-semibold transition-colors border-b-2"
						[ngClass]="activeTab === 'members' 
							? (isOsws ? 'gc-border-admin bg-[var(--gc-admin)]/10 gc-text-admin' : 'gc-border-primary bg-[var(--gc-primary)]/10 gc-text-primary')
							: 'border-transparent text-gray-600 hover:bg-gray-50'">
					<i class="fas fa-user-friends mr-2"></i>
					Members
					<span class="ml-2 px-2 py-0.5 rounded-full text-xs bg-gray-100">{{ trashedMembers.length }}</span>
				</button>
			</div>
		</div>
	</div>

	<!-- Loading state -->
	<div *ngIf="loading" role="status" aria-live="polite" class="mx-2 lg:mx-6">
		<div class="flex items-center justify-center py-12">
                <div class="flex flex-col items-center gap-3">
                	<i class="fas fa-spinner fa-spin text-4xl" [ngClass]="isOsws ? 'gc-text-admin' : 'gc-text-primary'"></i>
                	<p class="text-gray-600 font-semibold">Loading archived items...</p>
                </div>
		</div>
	</div>

	<!-- Error state -->
	<div *ngIf="error" class="mx-2 lg:mx-6 flex items-start gap-3 p-4 mb-6 rounded-lg border border-red-200 bg-red-50 text-red-700">
		<i class="fas fa-circle-exclamation text-xl mt-0.5"></i>
		<div class="flex-1">
			<div class="font-semibold text-base">Couldn't load archive</div>
			<div class="text-sm mt-1">{{ error }}</div>
		</div>
		<button type="button" 
				class="px-4 py-2 rounded-lg border border-red-300 bg-white hover:bg-red-100 font-semibold transition-colors" 
				(click)="loadTrash()">
			Try again
		</button>
	</div>

	<!-- Empty state -->
	<div *ngIf="!loading && !error && filtered.length === 0" class="text-gray-600 mx-2 lg:mx-6">
		<div class="flex flex-col items-center justify-center text-center py-16 border border-dashed border-gray-300 rounded-lg bg-white shadow-md">
			<div class="w-16 h-16 rounded-lg bg-gray-100 flex items-center justify-center mb-4">
				<i class="fas fa-archive text-3xl text-gray-400"></i>
			</div>
			<div class="text-lg font-semibold text-gray-700 mb-2">No items in archive</div>
			<div class="text-sm text-gray-500 max-w-md">
				{{ activeTab === 'events' ? 'Archived events' : 
				   activeTab === 'admins' ? 'Archived admin accounts' :
				   activeTab === 'organizations' ? 'Archived organizations' :
				   'Archived members' }} will appear here. Items are automatically deleted after 30 days.
			</div>
		</div>
	</div>

	<!-- Events View (Grid) -->
	<div *ngIf="!loading && !error && filtered.length > 0 && activeTab === 'events'" 
		 class="mx-0 sm:mx-2 lg:mx-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
		<div *ngFor="let ev of paginated" class="group flex flex-col bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all duration-300 border border-gray-200 hover:border-gray-300">
			<div class="h-32 sm:h-36 bg-gray-100 bg-cover bg-center relative" [style.backgroundImage]="posterUrl(ev) ? 'url(' + posterUrl(ev) + ')' : ''">
				<div class="absolute inset-0 flex items-center justify-center text-gray-300 text-4xl" *ngIf="!posterUrl(ev)">
					<i class="fas fa-image"></i>
				</div>
					<div class="absolute top-2 left-2 inline-flex items-center gap-1.5 text-xs font-bold px-3 py-1.5 rounded-lg shadow-lg border-2 bg-red-100 text-red-800 border-red-300">
					<i class="fas fa-trash-alt"></i>
					ARCHIVED
				</div>
			</div>
			
			<div class="flex-1 p-3 sm:p-4 flex flex-col">
				<h3 class="text-base sm:text-lg font-bold text-gray-800 line-clamp-2 mb-2">{{ ev.title || 'Untitled Event' }}</h3>
				
				<div class="space-y-1.5 text-xs sm:text-sm text-gray-600 mb-3 flex-1">
					<div class="flex items-start gap-2">
						<i class="fas fa-building text-gray-400 w-4 flex-shrink-0 mt-0.5"></i>
						<span class="line-clamp-1">{{ ev.org_name || ev.admin_name || 'Unknown Organizer' }}</span>
					</div>
					<div class="flex items-start gap-2">
						<i class="fas fa-map-marker-alt text-gray-400 w-4 flex-shrink-0 mt-0.5"></i>
						<span class="line-clamp-1">{{ ev.location || 'No location' }}</span>
					</div>
					<div class="flex items-start gap-2">
						<i class="fas fa-calendar text-gray-400 w-4 flex-shrink-0 mt-0.5"></i>
						<span>{{ ev.start_date || 'No date' }}</span>
					</div>
				</div>
				
				<div class="flex gap-2 mt-auto">
					    <button (click)="restore(ev)" 
						    [disabled]="restoringId === ev.event_id"
						    class="flex-1 px-3 py-2 rounded-lg font-semibold transition-all text-sm flex items-center justify-center gap-2 min-h-[44px]"
						    [ngClass]="isOsws ? 'gc-btn-admin' : 'gc-btn-primary'">
						<i class="fas" [ngClass]="restoringId === ev.event_id ? 'fa-spinner fa-spin' : 'fa-undo'"></i>
						<span>Restore</span>
					</button>
					<button (click)="deleteForever(ev)" 
							[disabled]="deletingId === ev.event_id"
							class="flex-1 px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white font-semibold transition-all text-sm flex items-center justify-center gap-2 disabled:opacity-50 min-h-[44px]">
						<i class="fas" [ngClass]="deletingId === ev.event_id ? 'fa-spinner fa-spin' : 'fa-trash-alt'"></i>
						<span>Delete</span>
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Table View for Admins, Organizations, and Members -->
	<div *ngIf="!loading && !error && filtered.length > 0 && activeTab !== 'events'" 
		 class="mx-0 sm:mx-2 lg:mx-6">
		<div class="bg-white rounded-lg shadow-md overflow-hidden">
			<!-- Desktop Table -->
			<div class="hidden md:block overflow-x-auto">
				<table class="min-w-full divide-y divide-gray-200">
				<thead [ngClass]="isOsws ? 'gc-bg-admin' : 'gc-bg-primary'">
					<tr class="text-white text-xs lg:text-sm">
						<th class="px-4 py-3 text-center font-semibold">#</th>
						<th class="px-4 py-3 text-center font-semibold">
							{{ activeTab === 'admins' ? 'Name' : 
							   activeTab === 'organizations' ? 'Organization' : 
							   'Member Name' }}
						</th>
						<th class="px-4 py-3 text-center font-semibold">Email</th>
						<th class="px-4 py-3 text-center font-semibold" *ngIf="activeTab === 'organizations' || activeTab === 'members'">Department</th>
						<th class="px-4 py-3 text-center font-semibold" *ngIf="activeTab === 'members'">Position</th>
							<th class="px-4 py-3 text-center font-semibold">Archived Date</th>
							<th class="px-4 py-3 text-center font-semibold">Actions</th>
						</tr>
					</thead>
					<tbody class="bg-white divide-y divide-gray-200">
						<tr *ngFor="let item of paginated; let i = index" 
							class="hover:bg-gray-50 transition-colors">
							<td class="px-4 py-3 text-sm font-semibold text-gray-700">
								{{ (currentPage - 1) * pageSize + i + 1 }}
							</td>
							<td class="px-4 py-3 text-sm font-semibold text-gray-800">
								{{ activeTab === 'admins' || activeTab === 'organizations' ? item.name || item.org_name : getFullName(item) }}
							</td>
							<td class="px-4 py-3 text-sm text-gray-600">
								<div class="flex items-center gap-2">
									<i class="fas fa-envelope text-xs text-gray-400"></i>
									{{ item.email }}
								</div>
							</td>
							<td class="px-4 py-3 text-sm text-gray-600" *ngIf="activeTab === 'organizations' || activeTab === 'members'">
								{{ item.department }}
							</td>
							<td class="px-4 py-3 text-sm text-gray-600" *ngIf="activeTab === 'members'">
								{{ item.position }}
							</td>
							<td class="px-4 py-3 text-sm text-gray-600 text-center">
								{{ item.deleted_at | date: 'MMM d, y' }}
							</td>
							<td class="px-4 py-3 text-center">
								<div class="flex items-center justify-center gap-2">
									    <button (click)="restore(item)" 
										    [disabled]="restoringId === (item.id || item.member_id)"
										    class="px-3 py-2 rounded-lg font-semibold transition-all text-xs flex items-center gap-2"
										    [ngClass]="isOsws ? 'gc-btn-admin' : 'gc-btn-primary'">
										<i class="fas" [ngClass]="restoringId === (item.id || item.member_id) ? 'fa-spinner fa-spin' : 'fa-undo'"></i>
										<span>Restore</span>
									</button>
									<button (click)="deleteForever(item)" 
											[disabled]="deletingId === (item.id || item.member_id)"
											class="px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white font-semibold transition-all text-xs flex items-center gap-2 disabled:opacity-50">
										<i class="fas" [ngClass]="deletingId === (item.id || item.member_id) ? 'fa-spinner fa-spin' : 'fa-trash-alt'"></i>
										<span>Delete</span>
									</button>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>

			<!-- Mobile Cards -->
			<div class="md:hidden space-y-3 p-4">
				<div *ngFor="let item of paginated; let i = index" 
					 class="bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden">
					<div class="px-4 py-3 flex justify-between items-center"
						[ngClass]="isOsws ? 'gc-bg-admin' : 'gc-bg-primary'">
						<div class="flex items-center gap-2">
							<span class="text-white text-xs font-bold px-2 py-1 rounded bg-white/20">
								{{ (currentPage - 1) * pageSize + i + 1 }}
							</span>
							<h3 class="text-white font-bold text-sm truncate">
								{{ activeTab === 'admins' || activeTab === 'organizations' ? item.name || item.org_name : getFullName(item) }}
							</h3>
						</div>
					</div>
					<div class="p-4 space-y-2">
						<div class="flex items-center gap-2 text-sm text-gray-600">
							<i class="fas fa-envelope text-gray-400 w-4"></i>
							<span class="truncate">{{ item.email }}</span>
						</div>
						<div class="flex items-center gap-2 text-sm text-gray-600" *ngIf="activeTab === 'organizations' || activeTab === 'members'">
							<i class="fas fa-building text-gray-400 w-4"></i>
							<span>{{ item.department }}</span>
						</div>
						<div class="flex items-center gap-2 text-sm text-gray-600" *ngIf="activeTab === 'members'">
							<i class="fas fa-user-tag text-gray-400 w-4"></i>
							<span>{{ item.position }}</span>
						</div>
						<div class="flex items-center gap-2 text-sm text-gray-600">
							<i class="fas fa-calendar text-gray-400 w-4"></i>
							<span>Archived: {{ item.deleted_at | date: 'MMM d, y' }}</span>
						</div>
						<div class="flex gap-2 pt-2">
							    <button (click)="restore(item)" 
								    [disabled]="restoringId === (item.id || item.member_id)"
								    class="flex-1 px-3 py-2 rounded-lg font-semibold transition-all text-sm flex items-center justify-center gap-2"
								    [ngClass]="isOsws ? 'gc-btn-admin' : 'gc-btn-primary'">
								<i class="fas" [ngClass]="restoringId === (item.id || item.member_id) ? 'fa-spinner fa-spin' : 'fa-undo'"></i>
								<span>Restore</span>
							</button>
							<button (click)="deleteForever(item)" 
									[disabled]="deletingId === (item.id || item.member_id)"
									class="flex-1 px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white font-semibold transition-all text-sm flex items-center justify-center gap-2 disabled:opacity-50">
								<i class="fas" [ngClass]="deletingId === (item.id || item.member_id) ? 'fa-spinner fa-spin' : 'fa-trash-alt'"></i>
								<span>Delete</span>
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Pagination -->
	<div *ngIf="!loading && !error && totalPages > 1" class="flex items-center justify-center gap-2 mt-6 mx-2 lg:mx-6">
		<button (click)="changePage(currentPage - 1)" 
				[disabled]="currentPage === 1"
				class="px-3 sm:px-4 py-2 rounded-lg border-2 border-gray-300 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-semibold text-sm min-h-[44px]"
				aria-label="Previous page">
			<i class="fas fa-chevron-left"></i>
		</button>
		
		<div class="flex items-center gap-1">
			<ng-container *ngFor="let page of [].constructor(totalPages); let i = index">
				<button *ngIf="i + 1 === 1 || i + 1 === totalPages || (i + 1 >= currentPage - 1 && i + 1 <= currentPage + 1)"
						(click)="changePage(i + 1)"
						class="px-3 sm:px-4 py-2 rounded-lg border-2 font-semibold transition-colors text-sm min-h-[44px] min-w-[44px]"
						[ngClass]="currentPage === i + 1 
							? (isOsws ? 'gc-bg-admin border-[#14532d] text-white' : 'gc-bg-primary border-[#2563eb] text-white')
							: 'border-gray-300 bg-white hover:bg-gray-50'">
					{{ i + 1 }}
				</button>
				<span *ngIf="(i + 1 === 2 && currentPage > 3) || (i + 1 === totalPages - 1 && currentPage < totalPages - 2)"
					  class="px-2 text-gray-500">...</span>
			</ng-container>
		</div>
		
		<button (click)="changePage(currentPage + 1)" 
				[disabled]="currentPage === totalPages"
				class="px-3 sm:px-4 py-2 rounded-lg border-2 border-gray-300 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-semibold text-sm min-h-[44px]"
				aria-label="Next page">
			<i class="fas fa-chevron-right"></i>
		</button>
	</div>
</div>
