<div class="p-6 bg-gray-100 min-h-screen">
	<!-- Header & actions: align with system palette and sticky header spacing -->
	<div class="mb-6 mx-2 lg:mx-6">
		<div class="flex items-center justify-between gap-3 flex-wrap">
			<div class="flex items-center gap-2 min-w-0">
				<h2 class="text-3xl font-bold truncate"
					[ngClass]="isOsws ? 'text-[#14532d]' : 'text-[#679436]'">Trash</h2>
				<span class="inline-flex items-center justify-center text-xs font-semibold px-2 py-0.5 rounded-full bg-gray-200 text-gray-700"
					  *ngIf="filtered && filtered.length >= 0">{{ filtered.length }}</span>
			</div>
			<div class="flex items-center gap-2 w-full sm:w-auto">
				<div class="relative flex-1 sm:flex-none sm:w-[300px] lg:w-[400px]">
					<i class="fas fa-search text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"></i>
					<input
						type="text"
						class="w-full pl-9 pr-8 py-2 border border-gray-300 rounded-md focus:outline-none"
						[ngClass]="isOsws ? 'focus:ring-2 focus:ring-[#14532d] focus:border-transparent' : 'focus:ring-2 focus:ring-[#679436] focus:border-transparent shadow-sm'"
						placeholder="Search title, department, host…"
						aria-label="Search trash"
						[(ngModel)]="search"
						(keyup.enter)="loadTrash()"
					/>
					<button *ngIf="search" type="button" aria-label="Clear search"
							class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600"
							(click)="search=''">
						<i class="fas fa-times"></i>
					</button>
				</div>
				<button type="button"
						class="text-white font-semibold px-4 py-2 rounded-md transition-all duration-200 flex items-center gap-2"
						[ngClass]="isOsws ? 'bg-[#14532d] hover:bg-[#218c4a]' : 'bg-[#679436] hover:bg-[#56732e]'"
						(click)="loadTrash()">
					<i class="fas fa-rotate"></i> <span>Refresh</span>
				</button>
			</div>
		</div>
	</div>

	<!-- Loading state -->
	<div *ngIf="loading" role="status" aria-live="polite" class="mx-2 lg:mx-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
		<div *ngFor="let i of [1,2,3,4,5,6]" class="border border-gray-200 rounded-xl overflow-hidden bg-white">
			<div class="h-36 bg-gray-100 animate-pulse"></div>
			<div class="p-3 space-y-2">
				<div class="h-4 bg-gray-100 rounded w-2/3 animate-pulse"></div>
				<div class="h-3 bg-gray-100 rounded w-1/2 animate-pulse"></div>
				<div class="h-3 bg-gray-100 rounded w-1/3 animate-pulse"></div>
			</div>
		</div>
	</div>

	<!-- Error state -->
	<div *ngIf="error" class="mx-2 lg:mx-6 flex items-start gap-3 p-3 mb-6 rounded-lg border border-red-200 bg-red-50 text-red-700">
		<i class="fas fa-circle-exclamation mt-0.5"></i>
		<div class="flex-1">
			<div class="font-medium">Couldn’t load trash</div>
			<div class="text-sm">{{ error }}</div>
		</div>
		<button type="button" class="px-3 py-1.5 rounded-md border border-red-200 hover:bg-red-100" (click)="loadTrash()">Try again</button>
	</div>

	<!-- Empty state -->
	<div *ngIf="!loading && !error && filtered.length === 0" class="text-gray-600 mx-2 lg:mx-6">
		<div class="flex flex-col items-center justify-center text-center py-12 border border-dashed border-gray-300 rounded-xl bg-white">
			<div class="text-3xl text-gray-400 mb-2"><i class="fas fa-trash"></i></div>
			<div class="text-lg font-medium">No items in trash</div>
			<div class="text-sm text-gray-500 mb-4">Deleted events will appear here for quick restore.</div>
			<button type="button"
					class="text-white font-semibold px-4 py-2 rounded-md transition-all duration-200 flex items-center gap-2"
					[ngClass]="isOsws ? 'bg-[#14532d] hover:bg-[#218c4a]' : 'bg-[#679436] hover:bg-[#56732e]'"
					(click)="loadTrash()">
				<i class="fas fa-rotate"></i> <span>Refresh</span>
			</button>
		</div>
	</div>

	<!-- Results -->
	<div *ngIf="!loading && !error && filtered.length > 0" class="mx-2 lg:mx-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
		<div *ngFor="let ev of filtered" class="group flex flex-col border border-gray-200 rounded-xl overflow-hidden bg-white shadow-sm hover:shadow-md transition-shadow">
			<div class="h-36 bg-gray-100 bg-cover bg-center relative" [style.backgroundImage]="posterUrl(ev) ? 'url(' + posterUrl(ev) + ')' : ''">
				<div class="absolute inset-0 flex items-center justify-center text-gray-300 text-3xl" *ngIf="!posterUrl(ev)">
					<i class="fas fa-image"></i>
				</div>
				<!-- Status indicator badge for UX: shows current status even in trash -->
				<div class="absolute top-2 left-2 inline-flex items-center gap-1 text-[10px] font-medium px-2 py-0.5 rounded-full shadow-sm"
					 [ngClass]="{
						'bg-green-100 text-green-800': (ev.status || '').toLowerCase() === 'completed',
						'bg-yellow-100 text-yellow-800': (ev.status || '').toLowerCase() === 'ongoing',
						'bg-gray-100 text-gray-800': (ev.status || '').toLowerCase() === 'not yet started',
						'bg-red-100 text-red-800': (ev.status || '').toLowerCase() === 'cancelled'
					 }">
					<i class="fas" [ngClass]="{
						'fa-circle-check': (ev.status || '').toLowerCase() === 'completed',
						'fa-play': (ev.status || '').toLowerCase() === 'ongoing',
						'fa-clock': (ev.status || '').toLowerCase() === 'not yet started',
						'fa-ban': (ev.status || '').toLowerCase() === 'cancelled'
					 }"></i>
					<span class="uppercase tracking-wide">{{ (ev.status || 'unknown') }}</span>
				</div>
			</div>
			<div class="p-3 space-y-2">
				<div class="font-semibold text-base truncate" [title]="ev.title">{{ ev.title }}</div>
				<div class="flex gap-3 flex-wrap text-gray-600 text-xs">
					<span class="inline-flex items-center gap-1" [title]="ev.start_date | date:'fullDate'">
						<i class="far fa-calendar"></i> {{ ev.start_date | date:'mediumDate' }}
					</span>
					<span class="inline-flex items-center gap-1 truncate max-w-full" [title]="ev.location || '—'">
						<i class="fas fa-map-marker-alt"></i> <span class="truncate">{{ ev.location || '—' }}</span>
					</span>
				</div>
				<div class="flex gap-2 flex-wrap text-gray-700 text-[11px]">
					<span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100">
						<i class="fas fa-user"></i> {{ ev.org_name || ev.admin_name || '—' }}
					</span>
					<span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100">
						<i class="fas fa-tag"></i> {{ ev.department || '—' }}
					</span>
				</div>
				<div class="text-xs text-gray-400">Deleted {{ ev.deleted_at | date:'medium' }}</div>
			</div>
			<div class="flex justify-end p-3 gap-2 border-t border-gray-100">
				<button type="button" aria-label="Restore event"
						class="px-3 py-2 rounded-md text-white"
						[ngClass]="isOsws ? 'bg-[#14532d] hover:bg-[#166534]' : 'bg-[#679436] hover:bg-[#56732e]'"
						(click)="restore(ev.event_id)">
						<i class="fas fa-undo"></i>
				</button>
					<button type="button" aria-label="Delete forever"
							class="px-3 py-2 rounded-md text-white bg-red-600 hover:bg-red-700"
							(click)="deleteForever(ev.event_id)">
						<i class="fas fa-trash-alt"></i>
					</button>
			</div>
		</div>
	</div>
</div>
